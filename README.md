# Архитектура и правила проекта custom.hr.card

Этот документ фиксирует **каноническую структуру** и **правила разработки** модуля. Он действует для всего проекта и всех будущих изменений. Надеюсь, я буду их соблюдать. Верю и клянусь)

---

## Каноническая структура каталогов

```
custom.hr.card/
├── index.php                # Точка подключения модуля (autoload, без логики)
├── install/
│   ├── index.php            # Установка / удаление (только register / unregister)
│   └── version.php          # Версия модуля
│
├── lib/
│   ├── Controller/
│   │   └── CardController.php        # Тонкий контроллер (входные точки)
│   │
│   ├── Service/
│   │   ├── SmartProcessService.php   # Работа со смарт-процессами
│   │   ├── DiskService.php            # Файлы, диск, загрузки
│   │   └── CandidateFactory.php       # Сборка DTO/моделей
│   │
│   ├── Placement/
│   │   └── SmartProcessCard.php       # Логика REST/placement
│   │
│   └── Config/
│       └── FieldMap.php               # Карта полей, константы
│
├── admin/
│   └── fields.php            # Admin UI (минимум логики)
│
├── assets/
│   ├── js/
│   │   └── card.js           # Клиентская логика карточки
│   └── css/
│       └── card.css
│
└── lang/
    └── ru/
        └── *.php             # Локализация
```

---

## Базовые принципы 

### 1. install/ — нередактируемая зона
- Никакой бизнес-логики
- Никаких запросов в БД
- Только register / unregister
- Никаких REST, CRM, Disk

### 2. index.php модуля
- Только autoload
- Никакого выполнения кода
- Никаких include логики

### 3. lib/
- Вся логика  здесь
- Классы маленькие, с одной ответственностью
- Контроллеры не содержат бизнес-логики

### 4. admin/
- Только UI
- Никаких прямых запросов к CRM
- Всё через Service-слой

### 5. assets/
- JS и CSS не знают о Bitrix API напрямую (не забыть перенести вебхуки из существующего скрипта в серверную часть)
- Общение только через AJAX / Controller

---

## Правила разработки

-  Не писать код «на потом»    (или писать. но не здесь. делаем чисто)
-  Не смешивать слои (UI ↔ бизнес)

---

## Этапы развития

1. Скелет
2. Пустая структура lib/
3. Autoload одного класса
4. Пустой admin-интерфейс
5. Placement без логики, только подкподключение к катрточке процесса 1032
6. Подключение сервисов
7. Клиентская логика



